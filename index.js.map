{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export { resetDomMarkup, domMarkup, markupGallery, innerDomMarkup };\n\nconst gallery = document.querySelector('.gallery');\n\nfunction markupGallery(fetchedData) {\n  return fetchedData\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return ` \n<li class=\"thumb\"> \n    <a href=\"${largeImageURL}\" \n            class=\"gallery-item\" > \n    <div class=\"photo-card\"> \n            <img src=\"${webformatURL}\" alt=\"${tags}\"  loading=\"lazy\" \n            class=\"gallery-image\"/> \n        <div class=\"info\"> \n            <p class=\"info-item\"> \n            <b>Likes</b>${likes} \n            </p> \n            <p class=\"info-item\"> \n            <b>Views</b>${views} \n            </p> \n            <p class=\"info-item\"> \n            <b>Comments</b>${comments} \n            </p> \n            <p class=\"info-item\"> \n            <b>Downloads</b>${downloads} \n            </p> \n         </div> \n    </div> \n    </a> \n</li>`;\n      }\n    )\n    .join('');\n}\n\nfunction resetDomMarkup() {\n  gallery.innerHTML = '';\n}\n\nfunction innerDomMarkup(markup) {\n  gallery.innerHTML = markup;\n}\n\nfunction domMarkup(resp) {\n  gallery.insertAdjacentHTML('beforeend', markupGallery(resp));\n}\n","import axios from 'axios';\n\nexport default class Gallery {\n  #API_KEY = '29527006-ad6e7c34d6702116665004a30';\n  #BASE_URL = 'https://pixabay.com/api/';\n\n  constructor() {\n    this.page = 1;\n    this.searchQuery = '';\n    this.per_page = 15;\n  }\n\n  async fetchPictures() {\n    const res = await axios.get(this.#BASE_URL, {\n      params: {\n        key: this.#API_KEY,\n        q: this.searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: this.page,\n        per_page: this.per_page,\n      },\n    });\n\n    return res.data;\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n}\n","import {\n  resetDomMarkup,\n  domMarkup,\n  markupGallery,\n  innerDomMarkup,\n} from './js/render-functions';\nimport Gallery from './js/pixabay-api';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  form: document.querySelector('#search-form'),\n  readmore: document.querySelector('.readmore'),\n  buttonToTop: document.querySelector('.scroll-to-top'),\n};\n\nconst instanse = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nrefs.form.addEventListener('submit', onSubmitForm);\nrefs.readmore.addEventListener('click', onLoadMore);\nrefs.buttonToTop.addEventListener('click', scrollToTop);\n\nconst NewGallery = new Gallery();\n\nasync function onSubmitForm(evt) {\n  evt.preventDefault();\n\n  const query = evt.currentTarget.searchQuery.value.trim();\n  NewGallery.query = query;\n\n  if (NewGallery.query === '') {\n    return showToast('info', 'Sorry', 'Please, type what you want  to search!');\n  }\n\n  updateUrlSearchParams(query);\n  NewGallery.resetPage();\n  resetDomMarkup();\n  showLoader();\n\n  try {\n    const { hits, totalHits } = await NewGallery.fetchPictures();\n    handleFetchResponse(hits, totalHits);\n  } catch (error) {\n    showError(error);\n  } finally {\n    hideLoader();\n    refs.form.reset();\n  }\n}\nasync function onLoadMore() {\n  NewGallery.incrementPage();\n  showLoader();\n\n  try {\n    const { hits, totalHits } = await NewGallery.fetchPictures();\n\n    domMarkup(hits);\n    smoothScrolling();\n    instanseRefresh();\n\n    if (NewGallery.page * NewGallery.per_page >= totalHits) {\n      onEndOfSearchRequest();\n    }\n  } catch (error) {\n    showError(error);\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction handleFetchResponse(hits, totalHits) {\n  if (hits.length === 0) {\n    refs.readmore.classList.add('hidden');\n    return showToast('error', 'No Results', 'No images found for your search!');\n  }\n\n  const markup = markupGallery(hits);\n  innerDomMarkup(markup);\n  instanseRefresh();\n\n  if (totalHits <= NewGallery.per_page) {\n    refs.readmore.classList.add('hidden');\n    onEndOfSearchRequest();\n  } else {\n    refs.readmore.classList.remove('hidden');\n  }\n}\n\nfunction showLoader() {\n  refs.loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('hidden');\n}\n\nfunction instanseRefresh() {\n  instanse.refresh('show.simplelightbox');\n}\n\nfunction smoothScrolling() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction scrollToTop() {\n  window.scrollTo({ top: 0, behavior: 'smooth' });\n}\n\nwindow.onscroll = () => changeScrollButtonVisibility();\n\nfunction changeScrollButtonVisibility() {\n  const offsetTrigger = 60;\n  const pageOffset = window.scrollY;\n\n  if (pageOffset > offsetTrigger) {\n    refs.buttonToTop.classList.remove('js-transparent');\n  } else {\n    refs.buttonToTop.classList.add('js-transparent');\n  }\n}\n\nfunction updateUrlSearchParams(query) {\n  const newUrl = new URL(window.location);\n  newUrl.searchParams.set('searchQuery', query);\n  window.history.pushState({}, '', newUrl);\n}\n\nfunction showToast(type, title, message) {\n  iziToast[type]({\n    position: 'topRight',\n    title: title,\n    message: message,\n  });\n}\n\nfunction showError(error) {\n  console.log('Error fetching images:', error.message);\n  showToast(\n    'error',\n    'Error',\n    'Something went wrong while fetching images. Please try again later!'\n  );\n}\n\nfunction onEndOfSearchRequest() {\n  refs.readmore.classList.add('hidden');\n  showToast(\n    'info',\n    'End of Search',\n    'You have reached the end of the results!'\n  );\n}\n"],"names":["gallery","markupGallery","fetchedData","webformatURL","largeImageURL","tags","likes","views","comments","downloads","resetDomMarkup","innerDomMarkup","markup","domMarkup","resp","Gallery","__privateAdd","_API_KEY","_BASE_URL","axios","__privateGet","newQuery","refs","instanse","SimpleLightbox","onSubmitForm","onLoadMore","scrollToTop","NewGallery","evt","query","showToast","updateUrlSearchParams","showLoader","hits","totalHits","handleFetchResponse","error","showError","hideLoader","smoothScrolling","instanseRefresh","onEndOfSearchRequest","cardHeight","changeScrollButtonVisibility","newUrl","type","title","message","iziToast"],"mappings":"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"}